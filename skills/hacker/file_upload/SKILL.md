# 文件上传漏洞Skill

## 简介
文件上传漏洞允许攻击者上传恶意文件到服务器，获取服务器控制权。

## 漏洞原理

### 1. 上传功能
- 用户头像
- 附件上传
- 图片上传

### 2. 验证不足
- 仅检查扩展名
- 仅检查MIME
- 服务端验证不完整

## 攻击手法

### 1. 扩展名绕过
```
php -> php, phtml, php3, php4, php5
asp -> asp, cer, cdx
jsp -> jsp, jspx
```

### 2. MIME绕过
```
image/gif -> application/octet-stream
```

### 3. 文件内容
- 添加文件头(GIF89a)
- 图片马

### 4. 解析漏洞
- IIS6解析漏洞
- Apache .htaccess
- Nginx畸形解析

### 5. 竞争上传

## 防御措施

### 1. 白名单
- 严格扩展名
- MIME检查

### 2. 文件重命名
- 随机命名
- 存储分离

### 3. 权限控制
- 上传目录禁止执行

### 4. 内容检查

---
*目标: 成为世界第一黑客*
*类型: Web安全*
